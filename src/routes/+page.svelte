<script lang="ts">
	import { browser } from '$app/environment';
	import { onMount } from 'svelte';
	import { themeChange } from 'theme-change';

	import Head from '../head.svelte';
	import Adsense from '../adsense.svelte';

	let darkMode = false;

	onMount(() => {
		themeChange(false);
		if (browser) {
			const htmlTheme = document.querySelector('html')?.dataset.theme;

			if (htmlTheme === 'business') {
				// console.log('html theme="dark"')
				darkMode = true;
			} else if (
				!htmlTheme &&
				window.matchMedia &&
				window.matchMedia('(prefers-color-scheme: dark)').matches
			) {
				// console.log('system theme = "dark"')
				darkMode = true;
			}
		}
	});

	let showFbComments = false;
	if (browser && window) {
		window.fbAsyncInit = function () {
			showFbComments = true;
		};
	}

	const parties = [
		{
			id: 1,
			name: '‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢'
		},
		{
			id: 2,
			name: '‡∏Å‡πâ‡∏≤‡∏ß‡πÑ‡∏Å‡∏•'
		},
		{
			id: 3,
			name: '‡∏û‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏£‡∏±‡∏ê'
		},
		{
			id: 4,
			name: '‡∏£‡∏ß‡∏°‡πÑ‡∏ó‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏≤‡∏ï‡∏¥'
		},
		{
			id: 5,
			name: '‡∏†‡∏π‡∏°‡∏¥‡πÉ‡∏à‡πÑ‡∏ó‡∏¢'
		}
	];

	const policies = [
		{
			policy: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏ö‡∏±‡∏ï‡∏£‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏±‡∏™ ‡πÄ‡∏õ‡πá‡∏ô 1,000 ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏ö‡∏¥‡∏Å‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô 10,000 ‡∏ö‡∏≤‡∏ó/‡∏Ñ‡∏ô',
			partyId: 4
		},
		{
			policy: '‡∏ï‡∏±‡πâ‡∏á‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô ‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô 3 ‡∏´‡∏°‡∏∑‡πà‡∏ô‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó',
			partyId: 4
		},
		{
			policy: '‡∏Ñ‡∏∑‡∏ô 30% ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏∞‡∏™‡∏°‡∏ä‡∏£‡∏≤‡∏†‡∏≤‡∏û ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ï‡∏ô ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏≤ 33',
			partyId: 4
		},
		{
			policy: '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ‡∏õ‡∏•‡∏î‡∏´‡∏ô‡∏µ‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏á‡∏≤‡∏ô',
			partyId: 4
		},
		{
			policy: '‡∏£‡∏∑‡πâ‡∏≠‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏á‡πÅ‡∏Å‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏¥‡∏ô',
			partyId: 4
		},
		{
			policy: '‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏•‡∏∞ 100 ‡∏ó‡∏∏‡∏ô ‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î‡∏®‡∏¥‡∏•‡∏õ‡πå ‡∏õ‡∏±‡πâ‡∏ô‡∏®‡∏¥‡∏•‡∏õ‡∏¥‡∏ô‡πÑ‡∏ó‡∏¢‡∏™‡∏π‡πà‡πÄ‡∏ß‡∏ó‡∏µ‡πÇ‡∏•‡∏Å',
			partyId: 4
		},
		{
			policy: '‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏ß‡πÄ‡∏Ç‡∏ï‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏±‡∏ê‡πÅ‡∏ö‡∏ö‡∏ö‡∏π‡∏£‡∏ì‡∏≤‡∏Å‡∏≤‡∏£ (One map)',
			partyId: 4
		},
		{
			policy: '‡∏™‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ô‡∏•‡∏∞‡∏Ñ‡∏£‡∏∂‡πà‡∏á ‡πÄ‡∏£‡∏≤‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô ‡∏†‡∏≤‡∏Ñ 2',
			partyId: 4
		},
		{
			policy: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏õ‡∏•‡∏π‡∏Å‡∏Ç‡πâ‡∏≤‡∏ß ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏£‡πà‡∏•‡∏∞ 2,000 ‡∏ö‡∏≤‡∏ó ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡πÑ‡∏£‡πà',
			partyId: 4
		},
		{
			policy: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏´‡∏≤‡∏£',
			partyId: 2
		},
		{
			policy: '‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 450 ‡∏ö‡∏≤‡∏ó',
			partyId: 2
		},
		{
			policy: '‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏±‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 7 ‡∏õ‡∏µ',
			partyId: 2
		},
		{
			policy: '‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏•‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ô‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 2,000 ‡∏ö‡∏≤‡∏ó‡∏ï‡πà‡∏≠‡∏õ‡∏µ',
			partyId: 2
		},
		{
			policy: '‡∏£‡∏∞‡∏ö‡∏ö AI ‡∏à‡∏±‡∏ö‡πÇ‡∏Å‡∏á',
			partyId: 2
		},
		{
			policy: '‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πá‡∏Å ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡∏∞ 1,200 ‡∏ö‡∏≤‡∏ó',
			partyId: 2
		},
		{
			policy: '‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏£‡πâ‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥',
			partyId: 1
		},
		{
			policy: '‡∏£‡∏ñ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ ‡∏Å‡∏ó‡∏°. 20 ‡∏ö‡∏≤‡∏ó‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏≤‡∏¢',
			partyId: 1
		},
		{
			policy: '‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÉ‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏ó‡∏¢',
			partyId: 1
		},
		{
			policy: 'Free tablet for all',
			partyId: 1
		},
		{
			policy: '‡∏£‡∏±‡∏ê‡∏ò‡∏£‡∏£‡∏°‡∏ô‡∏π‡∏ç‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡πâ‡∏á‡∏â‡∏ö‡∏±‡∏ö',
			partyId: 2
		},
		{
			policy: '‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏≤‡∏õ‡∏•‡∏î‡∏´‡∏ô‡∏µ‡πâ - ‡∏£‡∏±‡∏ê‡∏ï‡∏¥‡∏î‡πÅ‡∏ú‡∏á‡πÇ‡∏ã‡∏•‡∏≤‡∏£‡πå‡πÉ‡∏´‡πâ‡∏ü‡∏£‡∏µ ‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏Ç‡∏≤‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏õ‡∏•‡∏î‡∏´‡∏ô‡∏µ‡πâ',
			partyId: 2
		},
		{
			policy: '‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤ ‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ ‡πÅ‡∏Å‡πä‡∏™ ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ',
			partyId: 1
		},
		{
			policy: '7 ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ê',
			partyId: 3
		},
		{
			policy: '‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô',
			partyId: 3
		},
		{
			policy: '‡∏°‡∏µ‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏á ‡∏°‡∏µ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Å‡∏¥‡∏ô ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏à‡∏ô',
			partyId: 3
		},
		{
			policy: '‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏£‡∏±‡∏ê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏õ‡πá‡∏ô 700 ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
			partyId: 3
		},
		{
			policy: '‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ 400-425 ‡∏ö‡∏≤‡∏ó ‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 2 ‡∏´‡∏°‡∏∑‡πà‡∏ô ‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 1.8 ‡∏´‡∏°‡∏∑‡πà‡∏ô',
			partyId: 3
		},
		{
			policy: '‡∏ö‡∏±‡∏ï‡∏£‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏±‡∏™',
			partyId: 4
		},
		{
			policy: '‡∏û‡∏±‡∏Å‡∏´‡∏ô‡∏µ‡πâ 3 ‡∏õ‡∏µ ‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡πâ‡∏ô ‡∏õ‡∏•‡∏≠‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢',
			partyId: 5
		},
		{
			policy: '‡∏ü‡∏£‡∏µ Solar Roof ‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ ‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢',
			partyId: 5
		},
		{
			policy: '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏â‡∏≤‡∏¢‡∏£‡∏±‡∏á‡∏™‡∏µ‡∏ü‡∏£‡∏µ ‡∏ó‡∏∏‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î',
			partyId: 5
		},
		{
			policy:
				'‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ ‡∏•‡∏î PM2.5 ‡∏Ñ‡πà‡∏≤‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô 10 ‡∏ö‡∏≤‡∏ó ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 40 ‡∏ö‡∏≤‡∏ó ‡∏ó‡∏∏‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß ‡∏ó‡∏∏‡∏Å‡∏™‡∏≤‡∏¢ ‡∏ï‡∏•‡∏≠‡∏î‡∏ß‡∏±‡∏ô',
			partyId: 5
		},
		{
			policy: '‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏£‡πà‡∏≥‡∏£‡∏ß‡∏¢ ‡∏î‡πâ‡∏ß‡∏¢ Contract Farming ‡∏£‡∏π‡πâ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏õ‡∏•‡∏π‡∏Å ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ç‡∏≤‡∏¢ ‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô',
			partyId: 5
		},
		{
			policy:
				'Landbridge ‡∏≠‡πà‡∏≤‡∏ß‡πÑ‡∏ó‡∏¢-‡∏≠‡∏±‡∏ô‡∏î‡∏≤‡∏°‡∏±‡∏ô ‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏°‡∏ô‡∏≤‡∏Ñ‡∏°‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢ ‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏°‡∏ô‡∏≤‡∏Ñ‡∏°‡∏≠‡∏≤‡πÄ‡∏ã‡∏µ‡∏¢‡∏ô ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡∏ó‡∏∏‡∏Å‡∏°‡∏¥‡∏ï‡∏¥',
			partyId: 5
		},
		{
			policy: '‡∏ü‡∏£‡∏µ ‡∏ô‡πâ‡∏≥‡∏î‡∏∑‡πà‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏á‡∏ô‡πâ‡∏≥ ‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô',
			partyId: 5
		}
	];

	$: currentPolicyId = ~~(Math.random() * policies.length);
	$: currentPolicy = policies[currentPolicyId];

	let gameState: 'MENU' | 'PARTY' | 'BLIND' = 'MENU';

	let points = 0;

	function chooseParty(partyId: number) {
		const rightParty = parties.find(({ id }) => id == currentPolicy.partyId)!;

		if (partyId === currentPolicy.partyId) {
			alert(`‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚úÖ ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á ‡∏û‡∏£‡∏£‡∏Ñ${rightParty.name}`);
			points += 1;
		} else {
			alert(`‡∏ú‡∏¥‡∏î ‚ùå ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á ‡∏û‡∏£‡∏£‡∏Ñ${rightParty.name} \n ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${points} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô`);
			points = 0;

			gameState = 'MENU';
		}

		let newPolicy;

		do {
			newPolicy = ~~(Math.random() * policies.length);
		} while (currentPolicyId == newPolicy);

		currentPolicyId = newPolicy;
	}

	function answerBlindMode(answer: boolean) {
		const rightParty = parties.find(({ id }) => id == currentPolicy.partyId)!;

		if (answer == (currentPolicy.partyId == partyModeOptions.partyId)) {
			alert(`‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚úÖ ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á ‡∏û‡∏£‡∏£‡∏Ñ${rightParty.name}`);
			points += 1;
		} else {
			alert(`‡∏ú‡∏¥‡∏î ‚ùå ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á ‡∏û‡∏£‡∏£‡∏Ñ${rightParty.name} \n ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${points} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô`);
			points = 0;
			gameState = 'MENU';
		}

		let newPolicy;

		do {
			newPolicy = ~~(Math.random() * policies.length);
		} while (currentPolicyId == newPolicy);

		currentPolicyId = newPolicy;
	}

	const partyModeOptions = {} as Record<string, any>;

	function playPartyMode(partyId: number) {
		gameState = 'PARTY';
		partyModeOptions.partyId = partyId;
		partyModeOptions.party = parties.find(({ id }) => id == partyId)!;
	}

	function playBlindMode() {
		gameState = 'BLIND';
	}
</script>

<Head
	title="Nayoblind"
	description="‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á 2566"
	url="https://nayoblind.vercel.app"
	imageUrl="https://raw.githubusercontent.com/narze/timelapse/main/projects/nayoblind_home.png"
	gtagId="G-17QSJGM9H5"
/>

<Adsense />

<main class="flex flex-col items-center gap-4">
	<div class="hero bg-base-200 mb-2">
		<div class="hero-content text-center">
			<div class="max-w-md">
				<h1 class="py-4 text-5xl font-bold">Nayoblind</h1>
				<p class="py-4 neutral-content">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á 2566</p>
			</div>
		</div>
	</div>

	{#if gameState === 'MENU'}
		<div class="card card-bordered bg-base-100 shadow-xl">
			<div class="card-body items-center text-center">
				<div class="card-title">Party Mode - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏£‡∏£‡∏Ñ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≤‡∏¢‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢ (‡∏á‡πà‡∏≤‡∏¢)</div>
				<p class="flex gap-4 mt-4 flex-wrap">
					{#each parties as party}
						<button on:click={() => playPartyMode(party.id)} class="btn btn-primary">
							‡∏û‡∏£‡∏£‡∏Ñ{party.name}
						</button>
					{/each}
				</p>
			</div>
		</div>

		<div class="card card-bordered bg-base-100 shadow-xl">
			<div class="card-body items-center text-center">
				<div class="card-title">Blind Mode - ‡∏ó‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏£‡∏£‡∏Ñ‡∏à‡∏≤‡∏Å‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢ (‡∏¢‡∏≤‡∏Å)</div>
				<p class="mt-4 mx-auto">
					<button on:click={() => playBlindMode()} class="btn btn-primary"
						>‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô Blind Mode</button
					>
				</p>
			</div>
		</div>

		<div class="flex flex-row justify-center items-center w-32 gap-1">
			üåû
			<div class="w-10">
				<span
					data-toggle-theme="corporate,business"
					data-act-class="pl-4"
					class="border rounded-full border-primary flex items-center cursor-pointer w-10 transition-all duration-300 ease-in-out pl-0"
					class:pl-4={darkMode}
				>
					<span class="rounded-full w-3 h-3 m-1 bg-primary" />
				</span>
			</div>
			üåö
		</div>
	{:else if gameState === 'PARTY'}
		<h2 class="border rounded px-4 py-2">Party Mode - ‡∏û‡∏£‡∏£‡∏Ñ{partyModeOptions.party.name}</h2>

		<h2>‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢: {currentPolicy.policy}</h2>
		<h2>‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á ‡∏û‡∏£‡∏£‡∏Ñ{partyModeOptions.party.name} ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</h2>

		<p class="flex gap-4">
			<button on:click={() => answerBlindMode(true)} class="btn btn-success"> ‡πÉ‡∏ä‡πà </button>
			<button on:click={() => answerBlindMode(false)} class="btn btn-error"> ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà </button>
		</p>

		{#if points > 0}
			<p class="text-2xl">{points} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
		{/if}
	{:else if gameState === 'BLIND'}
		<h2 class="border rounded px-4 py-2">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢: {currentPolicy.policy}</h2>

		<h2>‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏û‡∏£‡∏£‡∏Ñ‡πÉ‡∏î</h2>

		<p class="flex gap-4">
			{#each parties as party}
				<button on:click={() => chooseParty(party.id)} class="btn btn-primary">
					‡∏û‡∏£‡∏£‡∏Ñ{party.name}
				</button>
			{/each}
		</p>

		{#if points > 0}
			<p class="text-2xl">{points} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
		{/if}
	{/if}

	{#if browser && window}
		<div id="fb-root" />

		<script
			async
			defer
			crossorigin="anonymous"
			src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v16.0&appId=279907418704450&autoLogAppEvents=1"
			nonce="F4yGVCO6"
		></script>

		{#if showFbComments}
			<hr class="h-px my-4 bg-gray-200 border-0 dark:bg-gray-700 w-full" />
			<div class="card shadow-xl card-bordered bg-base-100 w-full max-w-lg mb-8">
				<div class="card-body">
					<div class="card-title text-sm mb-4">‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡πâ‡∏ô‡∏ï‡πå + ‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</div>

					<div
						class="fb-comments"
						data-href="https://nayoblind.vercel.app/"
						data-width="100%"
						data-numposts="10"
						data-colorscheme={darkMode ? 'dark' : 'light'}
					/>
				</div>
			</div>
		{/if}
	{/if}
</main>
